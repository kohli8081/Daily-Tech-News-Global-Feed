<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daily Tech News â€” Global Feed</title>
  <meta name="description" content="A dynamic, auto-updating daily technology news blog that aggregates top stories from multiple sources worldwide." />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .tag { @apply text-xs font-medium px-2 py-0.5 rounded-full bg-gray-100 border border-gray-200; }
    .card { @apply bg-white border border-gray-200 rounded-2xl shadow-sm p-5 hover:shadow-md transition; }
    .grid-auto { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1rem; }
    .fade-in { animation: fade .4s ease-in both; }
    @keyframes fade { from { opacity: 0; transform: translateY(6px) } to { opacity: 1; transform: none } }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <header class="sticky top-0 z-50 backdrop-blur bg-white/80 border-b">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center gap-3">
      <div class="h-10 w-10 rounded-xl bg-black text-white grid place-items-center font-bold">TN</div>
      <div class="flex-1">
        <h1 class="text-xl md:text-2xl font-bold leading-tight">Daily Tech News â€” Global</h1>
        <p class="text-sm text-gray-600">Fresh tech headlines every day, from trusted sources worldwide. Auto-updated on each visit.</p>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 pt-6 pb-20">
    <!-- Indian Tech News Section -->
    <section id="indian-news" class="mb-10"></section>

    <!-- Controls -->
    <section class="mb-6 flex flex-col md:flex-row gap-3 md:items-center">
      <div class="flex-1 flex gap-2">
        <input id="search" type="search" placeholder="Search headlines (AI, Apple, cybersecurity, etc.)" class="w-full px-4 py-2.5 rounded-xl border outline-none focus:ring-2 focus:ring-black/10" />
        <select id="sourceFilter" class="px-3 py-2.5 rounded-xl border min-w-[160px] outline-none focus:ring-2 focus:ring-black/10">
          <option value="">All sources</option>
        </select>
        <select id="countryFilter" class="px-3 py-2.5 rounded-xl border min-w-[160px] outline-none focus:ring-2 focus:ring-black/10">
          <option value="">All countries</option>
          <option value="India">India</option>
          <option value="Global">Global</option>
        </select>
      </div>
      <div class="flex gap-2">
        <select id="days" class="px-3 py-2.5 rounded-xl border outline-none focus:ring-2 focus:ring-black/10">
          <option value="1">Today</option>
          <option value="3" selected>Last 3 days</option>
          <option value="7">Last 7 days</option>
        </select>
        <button id="refreshBtn" class="px-4 py-2.5 rounded-xl border bg-white hover:bg-gray-50 font-semibold">Refresh</button>
      </div>
    </section>

    <!-- Daily Digest -->
    <section id="digest" class="mb-8"></section>

    <!-- News groups by day -->
    <section id="news" class="space-y-8"></section>

    <footer class="mt-16 text-center text-sm text-gray-500">
      <p>Built with vanilla JS + RSS. No API key needed. Sources: TechCrunch, The Verge, Ars Technica, Engadget, WIRED, Hacker News, Gadgets360 India, NDTV Tech.</p>
    </footer>
  </main>

  <script>
    // ====== Configuration ======
    const SOURCES = [
      { name: 'Gadgets360 India', url: 'https://feeds.feedburner.com/gadgets360-latest', country: 'India' },
      { name: 'NDTV Tech', url: 'https://feeds.feedburner.com/ndtvnews-ndtvtech', country: 'India' },
      { name: 'TechCrunch', url: 'https://techcrunch.com/feed/', country: 'Global' },
      { name: 'The Verge', url: 'https://www.theverge.com/tech/rss/index.xml', country: 'Global' },
      { name: 'Ars Technica', url: 'https://feeds.arstechnica.com/arstechnica/technology-lab', country: 'Global' },
      { name: 'Engadget', url: 'https://www.engadget.com/rss.xml', country: 'Global' },
      { name: 'WIRED', url: 'https://www.wired.com/feed/rss', country: 'Global' },
      { name: 'Hacker News', url: 'https://hnrss.org/frontpage', country: 'Global' },
    ];

    const PROXY = 'https://api.allorigins.win/raw?url=';

    const $ = sel => document.querySelector(sel);
    const fmtDate = (d) => d.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: '2-digit' });

    function uniqueBy(arr, keyFn) {
      const seen = new Set();
      return arr.filter(item => {
        const k = keyFn(item);
        if (seen.has(k)) return false;
        seen.add(k);
        return true;
      });
    }

    function parseRSS(xmlText, source) {
      const parser = new DOMParser();
      const xml = parser.parseFromString(xmlText, 'text/xml');
      const items = [...xml.querySelectorAll('item')].map(el => ({
        title: el.querySelector('title')?.textContent?.trim() || 'Untitled',
        link: el.querySelector('link')?.textContent?.trim() || '#',
        pubDate: new Date(el.querySelector('pubDate')?.textContent || Date.now()),
        source: source.name,
        country: source.country,
        description: el.querySelector('description')?.textContent || '',
      }));
      return items;
    }

    async function fetchFeed(src) {
      const url = PROXY + encodeURIComponent(src.url);
      const res = await fetch(url);
      if (!res.ok) throw new Error('Fetch failed for ' + src.name);
      const txt = await res.text();
      return parseRSS(txt, src);
    }

    async function loadNews() {
      toggleLoading(true);
      const daysBack = parseInt($('#days').value, 10);

      const results = await Promise.allSettled(SOURCES.map(fetchFeed));
      let articles = [];
      results.forEach((r, i) => {
        if (r.status === 'fulfilled') articles = articles.concat(r.value);
      });

      const now = new Date();
      const cutoff = new Date(now.getTime() - daysBack*24*60*60*1000);
      articles = articles.filter(a => a.pubDate >= cutoff);
      articles = uniqueBy(articles, a => a.title + a.source);
      articles.sort((a, b) => b.pubDate - a.pubDate);

      renderIndianNews(articles);
      renderDigest(articles);
      renderByDay(articles);
      toggleLoading(false);
    }

    function renderIndianNews(articles) {
      const container = $('#indian-news');
      const indianArticles = articles.filter(a => a.country === 'India');
      if (!indianArticles.length) return;

      const list = indianArticles.slice(0, 6).map(a => `
        <li class="flex gap-2 items-start">
          <span class="tag">${a.source}</span>
          <a class="underline decoration-dotted hover:no-underline" href="${a.link}" target="_blank">${a.title}</a>
        </li>
      `).join('');

      container.innerHTML = `
        <div class="card fade-in">
          <h2 class="text-lg md:text-xl font-bold mb-2">ðŸ‡®ðŸ‡³ Indian Tech News</h2>
          <ul class="space-y-2">${list}</ul>
        </div>
      `;
    }

    function renderDigest(articles) {
      const container = $('#digest');
      container.innerHTML = '';
      if (!articles.length) return;
      const latestDay = articles[0].pubDate.toLocaleDateString();
      const dayArticles = articles.filter(a => a.pubDate.toLocaleDateString() === latestDay).slice(0, 10);
      const bullets = dayArticles.map(a => `
        <li class="flex gap-2 items-start">
          <span class="tag shrink-0">${a.source}</span>
          <a class="underline decoration-dotted hover:no-underline" href="${a.link}" target="_blank">${a.title}</a>
        </li>
      `).join('');

      container.innerHTML = `
        <div class="card fade-in">
          <h2 class="text-lg md:text-xl font-bold mb-2">Daily Tech Digest</h2>
          <ul class="space-y-2">${bullets}</ul>
        </div>
      `;
    }

    function renderByDay(articles) {
      const wrap = $('#news');
      wrap.innerHTML = '';
      if (!articles.length) return;

      const countrySel = $('#countryFilter').value;
      let filtered = articles;
      if (countrySel) filtered = filtered.filter(a => a.country === countrySel);

      const groups = {};
      for (const a of filtered) {
        const key = a.pubDate.toDateString();
        (groups[key] ||= []).push(a);
      }
      const days = Object.keys(groups).sort((a,b) => new Date(b) - new Date(a));
      for (const d of days) {
        const list = groups[d];
        const cards = list.map(a => ArticleCard(a)).join('');
        const section = document.createElement('section');
        section.className = 'space-y-4 fade-in';
        section.innerHTML = `
          <h3 class="text-lg md:text-xl font-bold">${d}</h3>
          <div class="grid-auto">${cards}</div>
        `;
        wrap.appendChild(section);
      }
    }

    function ArticleCard(a) {
      return `
        <article class="card">
          <div class="flex items-start justify-between gap-3 mb-2">
            <span class="tag">${a.source}</span>
            <span class="tag">${a.country}</span>
          </div>
          <a class="block text-base md:text-lg font-semibold hover:underline" href="${a.link}" target="_blank">${a.title}</a>
        </article>
      `;
    }

    function toggleLoading(is) {
      $('#refreshBtn').disabled = is;
      $('#refreshBtn').textContent = is ? 'Loadingâ€¦' : 'Refresh';
    }

    $('#refreshBtn').onclick = loadNews;
    $('#days').onchange = loadNews;
    $('#countryFilter').onchange = loadNews;

    loadNews();
  </script>
</body>
</html>
